<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ‚úÖ FAVICON RESTORED -->
<link rel="icon" type="image/png" href="favicon.png">

<title>TrackMyMNY</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{box-sizing:border-box;}

body{
margin:0;
font-family:'Inter',sans-serif;
background:linear-gradient(135deg,#0f172a,#1e293b);
color:white;
transition:.3s;
}

header{
padding:18px;
display:flex;
justify-content:flex-end;
}

.toggle-btn{
background:rgba(255,255,255,0.2);
padding:8px 12px;
border-radius:50%;
cursor:pointer;
}

.container{
max-width:1200px;
margin:auto;
padding:20px;
}

.card{
background:rgba(255,255,255,0.08);
backdrop-filter:blur(25px);
border-radius:22px;
padding:22px;
margin-bottom:22px;
}

.dashboard{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
gap:20px;
margin-bottom:22px;
}

.balance{font-size:26px;font-weight:700;color:#22c55e;}
.credit{color:#3b82f6;}
.debit{color:#ef4444;}

.form-grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
gap:12px;
}

input,select{
padding:10px;
border-radius:10px;
border:1px solid rgba(255,255,255,0.3);
background:rgba(255,255,255,0.2);
color:white;
}

select option{background:#1e293b;color:white;}

button{
padding:10px;
border:none;
border-radius:10px;
background:#3b82f6;
color:white;
cursor:pointer;
font-weight:600;
}

.table-wrapper{overflow-x:auto;}

table{
width:100%;
border-collapse:collapse;
background:rgba(255,255,255,0.08);
border-radius:18px;
min-width:600px;
}

/* üî• No blue header in dark mode */
th{
background:transparent;
padding:10px;
border-bottom:1px solid rgba(255,255,255,0.2);
}

td{padding:8px;text-align:center;}

.type-debit{color:#ef4444;font-weight:600;}
.type-credit{color:#22c55e;font-weight:600;}

.category-badge{
padding:4px 10px;
border-radius:12px;
font-weight:600;
display:inline-block;
color:white;
font-size:12px;
}

.delete-btn{
background:#ef4444;
border:none;
padding:5px 8px;
border-radius:6px;
color:white;
cursor:pointer;
}

.summary-box{
margin-top:12px;
padding:12px;
border-radius:14px;
background:rgba(255,255,255,0.1);
}

canvas{
margin-top:20px;
background:rgba(255,255,255,0.08);
border-radius:20px;
padding:15px;
}

/* LIGHT MODE */
.light{
background:linear-gradient(135deg,#ffffff,#e2e8f0);
color:#111;
}

.light .card,
.light table,
.light canvas{
background:white;
color:#111;
}

.light th{
background:#f8fafc;
color:#111;
border-bottom:1px solid #ddd;
}

.light input,.light select{
background:#f1f5f9;
color:#111;
border:1px solid #ccc;
}

@media(max-width:768px){
.dashboard{grid-template-columns:1fr;}
}

</style>
</head>

<body>

<header>
<span class="toggle-btn" onclick="toggleMode()">üåô</span>
</header>

<div class="container">

<div class="dashboard">
<div class="card"><h3>Total Balance</h3><div class="balance" id="balance">‚Çπ0</div></div>
<div class="card"><h3>Total Credit</h3><div class="credit" id="totalCredit">‚Çπ0</div></div>
<div class="card"><h3>Total Debit</h3><div class="debit" id="totalDebit">‚Çπ0</div></div>
</div>

<div class="card">
<h3>Add Transaction</h3>
<div class="form-grid">
<input type="date" id="date">
<select id="type">
<option value="Credit">Credit</option>
<option value="Debit">Debit</option>
</select>
<select id="category">
<option>Salary</option>
<option>Food</option>
<option>Transportation</option>
<option>Hospital</option>
<option>Mess Fees</option>
<option>Supermarket</option>
<option>Movie Ticket</option>
<option>Cake</option>
<option>Bed</option>
<option>Agrements & Rent</option>
<option>Others</option>
</select>
<input type="number" id="amount" placeholder="Amount">
<button onclick="addTransaction()">Add</button>
</div>
</div>

<div class="card">
<h3>Filters</h3>

<select id="monthSelect" onchange="populateDates(); renderTable();">
<option value="all">All Months</option>
<option value="0">January</option>
<option value="1">February</option>
<option value="2">March</option>
<option value="3">April</option>
<option value="4">May</option>
<option value="5">June</option>
<option value="6">July</option>
<option value="7">August</option>
<option value="8">September</option>
<option value="9">October</option>
<option value="10">November</option>
<option value="11">December</option>
</select>

<select id="dateSelect" onchange="renderTable()">
<option value="all">All Dates</option>
</select>

<p><strong>Total Spent:</strong> ‚Çπ<span id="filteredTotal">0</span></p>
<div id="dailyCategorySummary" class="summary-box"></div>
</div>

<div class="card table-wrapper">
<table>
<thead>
<tr>
<th>Date</th>
<th>Type</th>
<th>Category</th>
<th>Amount</th>
<th>Action</th>
</tr>
</thead>
<tbody id="transactionTable"></tbody>
</table>
</div>

<div class="card">
<canvas id="expenseChart"></canvas>
</div>

</div>

<script>

/* üé® UNIQUE COLOR SYSTEM */
let chart;

let fullColorPalette=[
"#3b82f6","#ef4444","#22c55e","#f59e0b","#8b5cf6","#14b8a6",
"#e11d48","#6366f1","#10b981","#f97316","#06b6d4","#a855f7",
"#84cc16","#f43f5e","#0ea5e9","#d946ef","#facc15","#0f766e",
"#be123c","#4338ca","#15803d","#ea580c","#7e22ce","#0891b2",
"#65a30d","#db2777","#1d4ed8","#047857","#b45309","#6d28d9"
];

let categoryColorMap={};
let usedColors=new Set();

function getCategoryColor(category){
if(categoryColorMap[category]) return categoryColorMap[category];
for(let color of fullColorPalette){
if(!usedColors.has(color)){
categoryColorMap[category]=color;
usedColors.add(color);
return color;
}
}
let randomColor="#" + Math.floor(Math.random()*16777215).toString(16);
categoryColorMap[category]=randomColor;
return randomColor;
}

/* FULL PREVIOUS EXPENSES */
let previousTransactions=[
{date:"2026-01-19",type:"Debit",category:"Supermarket",amount:340},
{date:"2026-01-19",type:"Debit",category:"Bed",amount:650},
{date:"2026-01-20",type:"Debit",category:"Food",amount:313},
{date:"2026-01-20",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-20",type:"Debit",category:"Agrements & Rent",amount:4100},
{date:"2026-01-21",type:"Debit",category:"Food",amount:257},
{date:"2026-01-21",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-22",type:"Debit",category:"Food",amount:250},
{date:"2026-01-22",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-23",type:"Debit",category:"Food",amount:250},
{date:"2026-01-23",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-24",type:"Debit",category:"Food",amount:211},
{date:"2026-01-24",type:"Debit",category:"Transportation",amount:298},
{date:"2026-01-26",type:"Debit",category:"Food",amount:297},
{date:"2026-01-26",type:"Debit",category:"Transportation",amount:352},
{date:"2026-01-27",type:"Debit",category:"Food",amount:370},
{date:"2026-01-27",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-28",type:"Debit",category:"Food",amount:286},
{date:"2026-01-28",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-29",type:"Debit",category:"Food",amount:180},
{date:"2026-01-29",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-29",type:"Debit",category:"Supermarket",amount:117},
{date:"2026-01-30",type:"Debit",category:"Food",amount:160},
{date:"2026-01-30",type:"Debit",category:"Transportation",amount:60},
{date:"2026-01-31",type:"Debit",category:"Food",amount:221},
{date:"2026-01-31",type:"Debit",category:"Transportation",amount:117},
{date:"2026-02-01",type:"Debit",category:"Food",amount:319},
{date:"2026-02-01",type:"Debit",category:"Transportation",amount:112},
{date:"2026-02-02",type:"Debit",category:"Food",amount:1400},
{date:"2026-02-02",type:"Debit",category:"Transportation",amount:60},
{date:"2026-02-03",type:"Debit",category:"Food",amount:110},
{date:"2026-02-03",type:"Debit",category:"Transportation",amount:60},
{date:"2026-02-04",type:"Debit",category:"Food",amount:300},
{date:"2026-02-04",type:"Debit",category:"Transportation",amount:60},   
{date:"2026-02-05",type:"Credit",category:"Salary",amount:15000},
{date:"2026-02-05",type:"Debit",category:"Food",amount:115},
{date:"2026-02-05",type:"Debit",category:"Transportation",amount:60},
{date:"2026-02-06",type:"Debit",category:"Food",amount:214},
{date:"2026-02-06",type:"Debit",category:"Transportation",amount:60},
{date:"2026-02-07",type:"Debit",category:"Food",amount:227},
{date:"2026-02-07",type:"Debit",category:"Transportation",amount:60},
{date:"2026-02-08",type:"Debit",category:"Hospital",amount:2400},
{date:"2026-02-08",type:"Debit",category:"Food",amount:275},
{date:"2026-02-09",type:"Debit",category:"Food",amount:250},
{date:"2026-02-10",type:"Debit",category:"Food",amount:270},
{date:"2026-02-10",type:"Debit",category:"Transportation",amount:145},
{date:"2026-02-10",type:"Debit",category:"Movie Ticket",amount:120},
{date:"2026-02-11",type:"Debit",category:"Food",amount:290},
{date:"2026-02-11",type:"Debit",category:"Transportation",amount:100},
{date:"2026-02-11",type:"Debit",category:"Cake",amount:104},
{date:"2026-02-12",type:"Debit",category:"Food",amount:400},
{date:"2026-02-12",type:"Debit",category:"Transportation",amount:100},
{date:"2026-02-12",type:"Debit",category:"Supermarket",amount:100},
{date:"2026-02-13",type:"Debit",category:"Food",amount:168},
{date:"2026-02-13",type:"Debit",category:"Transportation",amount:310},
{date:"2026-02-15",type:"Debit",category:"Transportation",amount:210},
{date:"2026-02-15",type:"Debit",category:"Mess Fees",amount:3405}
];

let transactions=[];
let balance=0,totalCredit=0,totalDebit=0;

document.addEventListener("DOMContentLoaded",()=>{
document.getElementById("date").value=new Date().toISOString().split('T')[0];
});

document.addEventListener("keydown",function(e){
if(e.key==="Enter"){e.preventDefault();addTransaction();}
});

function toggleMode(){document.body.classList.toggle("light");}

function addTransaction(){
let date=document.getElementById("date").value;
let type=document.getElementById("type").value;
let category=document.getElementById("category").value;
let amount=parseFloat(document.getElementById("amount").value);
if(!date||!amount)return alert("Enter required fields");
transactions.push({date,type,category,amount});
document.getElementById("amount").value="";
populateDates();
renderTable();
}

function calculateTotals(){
balance=0;totalCredit=0;totalDebit=0;
let startDate=new Date("2026-02-05");
let all=[...previousTransactions,...transactions];
all.forEach(t=>{
let d=new Date(t.date);
if(d>=startDate){
if(t.type==="Credit"){balance+=t.amount;totalCredit+=t.amount;}
else{balance-=t.amount;totalDebit+=t.amount;}
}
});
document.getElementById("balance").innerText="‚Çπ"+balance;
document.getElementById("totalCredit").innerText="‚Çπ"+totalCredit;
document.getElementById("totalDebit").innerText="‚Çπ"+totalDebit;
}

function populateDates(){
let month=document.getElementById("monthSelect").value;
let dateSelect=document.getElementById("dateSelect");
dateSelect.innerHTML='<option value="all">All Dates</option>';
let all=[...previousTransactions,...transactions];
let uniqueDates=new Set();
all.forEach(t=>{
let m=new Date(t.date).getMonth();
if(month==="all"||m==month)uniqueDates.add(t.date);
});
Array.from(uniqueDates).sort().forEach(d=>{
dateSelect.innerHTML+=`<option value="${d}">${d}</option>`;
});
}

function renderTable(){
let month=document.getElementById("monthSelect").value;
let selectedDate=document.getElementById("dateSelect").value;
let table=document.getElementById("transactionTable");
table.innerHTML="";
let categoryTotals={};
let total=0;

let all=[...previousTransactions,...transactions];

/* üî• MERGE SAME DATE + TYPE + CATEGORY */
let mergedMap={};

all.forEach(t=>{
let key=t.date+"_"+t.type+"_"+t.category;

if(!mergedMap[key]){
mergedMap[key]={...t};
}else{
mergedMap[key].amount+=t.amount;
}
});

let merged=Object.values(mergedMap);

/* Sort descending by date */
merged.sort((a,b)=>new Date(b.date)-new Date(a.date));

merged.forEach(t=>{
let m=new Date(t.date).getMonth();

if((month==="all"||m==month)&&(selectedDate==="all"||t.date===selectedDate)){
let typeClass=t.type==="Debit"?"type-debit":"type-credit";
let color=getCategoryColor(t.category);

if(t.type==="Debit"){
total+=t.amount;
if(!categoryTotals[t.category])categoryTotals[t.category]=0;
categoryTotals[t.category]+=t.amount;
}

let newIndex=transactions.findIndex(
x=>x.date===t.date && x.type===t.type && x.category===t.category
);

let del=newIndex!=-1?
`<button class="delete-btn" onclick="deleteTransaction(${newIndex})">‚ùå</button>`:"-";

table.innerHTML+=`
<tr>
<td>${t.date}</td>
<td class="${typeClass}">${t.type}</td>
<td><span class="category-badge" style="background:${color}">${t.category}</span></td>
<td>‚Çπ${t.amount}</td>
<td>${del}</td>
</tr>`;
}
});

document.getElementById("filteredTotal").innerText=total;
updateChart(categoryTotals);
calculateTotals();
}


function updateChart(data){
if(chart)chart.destroy();
let labels=Object.keys(data);
let colors=labels.map(cat=>getCategoryColor(cat));
chart=new Chart(document.getElementById("expenseChart"),{
type:'doughnut',
data:{
labels:labels,
datasets:[{
data:Object.values(data),
backgroundColor:colors
}]
}
});
}

function deleteTransaction(i){
transactions.splice(i,1);
populateDates();
renderTable();
}

populateDates();
renderTable();

</script>

</body>
</html>
